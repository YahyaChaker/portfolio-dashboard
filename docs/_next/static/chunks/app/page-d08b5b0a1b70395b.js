(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{83686:()=>{},32383:()=>{},16793:(e,t,a)=>{Promise.resolve().then(a.bind(a,43531))},43531:(e,t,a)=>{"use strict";a.d(t,{default:()=>T});var s=a(95155),r=a(12115),l=a(92510),i=a(7660);let n=r.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"rounded-lg border bg-card text-card-foreground shadow-sm ".concat(a),...r})});n.displayName="Card";let c=r.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"flex flex-col space-y-1.5 p-6 ".concat(a),...r})});c.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("h3",{ref:t,className:"text-2xl font-semibold leading-none tracking-tight ".concat(a),...r})});d.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("p",{ref:t,className:"text-sm text-muted-foreground ".concat(a),...r})}).displayName="CardDescription";let x=r.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"p-6 pt-0 ".concat(a),...r})});x.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"flex items-center p-6 pt-0 ".concat(a),...r})}).displayName="CardFooter";var o=a(58581),m=a(394),h=a(15255),j=a(12800),g=a(66963),p=a(27112),u=a(23021),f=a(67732),N=a(56695),y=a(8710),b=a(90518),v=a(22175),w=a(90457);let P={Ongoing:"#0d9488",Mobilisation:"#0369a1","Not Started":"#64748b"},C={High:{bg:"bg-red-100",text:"text-red-800"},Medium:{bg:"bg-yellow-100",text:"text-yellow-800"},Normal:{bg:"bg-green-100",text:"text-green-800"}},M={"Commercial Boulevard District Lusail":"High","Korean Medical Center":"Normal","Al Seef Tower":"Medium","Pumping Stations":"High","QNB Tower":"High","QD Tower Lusail Plaza Tower Plot 4":"Normal","Lusail Plaza Tower # 1 (Plot 1)":"High"},S=e=>"string"==typeof e?parseFloat(e.replace(/,/g,""))||0:"number"==typeof e?e:0,D=e=>"string"==typeof e?parseFloat(e.replace("%",""))/100||0:"number"==typeof e?e:0,k=e=>M[e]||"Normal",E=e=>{if(!e)return 0;try{let[t,a,s]=e.split("-"),r=parseInt(t,10),l=2e3+parseInt(s,10),i=new Date(l,{Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[a],r),n=new Date,c=i.getFullYear()-n.getFullYear(),d=i.getMonth()-n.getMonth(),x=i.getDate()-n.getDate();return Math.max(0,Math.ceil(12*c+d+x/30))}catch(e){return console.error("Error calculating time remaining:",e),0}};class F extends r.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Chart Error:",e,t)}render(){return this.state.hasError?(0,s.jsx)("div",{className:"flex items-center justify-center h-96 bg-gray-50 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-gray-500 mb-2",children:"Unable to load chart"}),(0,s.jsx)("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"text-sm text-blue-500 hover:text-blue-600",children:"Try again"})]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null}}}let T=()=>{let[e,t]=r.useState([]),[a,M]=r.useState(!0);if(r.useEffect(()=>{(async()=>{try{M(!0);let e=await fetch("./One Page Portfolio.xlsx");if(!e.ok)throw Error("Failed to fetch data: ".concat(e.status," ").concat(e.statusText));let a=await e.arrayBuffer(),s=i.LF(new Uint8Array(a),{type:"array",cellDates:!1,cellNF:!0,cellText:!1,cellStyles:!0}),r=s.Sheets[s.SheetNames[0]],l=i.Wp.sheet_to_json(r,{raw:!1,dateNF:"dd/mm/yyyy"}).filter(e=>e["Project Name"]&&"Total"!==e["Project Name"]&&e.Status in P);t(l)}catch(e){console.error("Error loading data:",e)}finally{M(!1)}})()},[]),a)return(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsx)("div",{className:"text-lg text-gray-600",children:"Loading portfolio data..."})});let T=e.reduce((e,t)=>e+S(t["Contract Value"]),0),A=e.reduce((e,t)=>e+S(t.manpower),0);e.map(t=>({name:t["Project Name"],"Contract Value":S(t["Contract Value"])/T*100,Duration:S(t["Duration (Months)"])/e.reduce((e,t)=>Math.max(e,S(t["Duration (Months)"])),0)*100,Manpower:S(t.manpower)/A*100,Progress:100*D(t["Time spending"])}));let V=e.map(e=>({name:e["Project Name"],"Contract Value":S(e["Contract Value"])/1e6,manpower:S(e.manpower),"Duration (Months)":S(e["Duration (Months)"]),status:e.Status,progress:100*D(e["Time spending"])})).sort((e,t)=>e["Contract Value"]-t["Contract Value"]);return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-gray-50",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto p-8",children:[(0,s.jsxs)("div",{className:"first-page",children:[(0,s.jsx)("div",{className:"mb-6 bg-white rounded-xl shadow-lg p-6 border border-teal-100",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-light text-gray-800 mb-2",children:"Portfolio Overview"}),(0,s.jsx)("p",{className:"text-gray-500 text-xl",children:"Yahya Chaker"}),(0,s.jsx)("p",{className:"text-gray-500 text-lg",children:"FM Projects Director"})]}),(0,s.jsxs)("div",{className:"flex gap-8",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-4xl font-light text-teal-600",children:e.length}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Projects"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("p",{className:"text-4xl font-light text-teal-600",children:[(T/1e6).toFixed(1),"M"]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"QAR Value"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-4xl font-light text-teal-600",children:A}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Personnel"})]})]}),(0,s.jsx)("div",{className:"border-l border-gray-200 pl-8",children:(0,s.jsx)("img",{src:"/Elegancia_Logo.png",alt:"Elegancia Logo",className:"h-16 w-auto"})})]})}),(0,s.jsxs)("div",{className:"flex gap-6 mb-8",children:[(0,s.jsxs)(n,{className:"bg-white shadow-lg flex-1",children:[(0,s.jsx)(c,{children:(0,s.jsx)(d,{className:"text-xl font-light",children:"Project Contract Values"})}),(0,s.jsx)(x,{children:(0,s.jsx)(F,{children:(0,s.jsx)("div",{className:"h-[350px]",children:(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(m.E,{data:e.map(e=>({name:e["Project Name"],value:S(e["Contract Value"])/1e6})),layout:"vertical",margin:{top:5,right:30,left:5,bottom:5},children:[(0,s.jsx)(h.d,{strokeDasharray:"3 3",horizontal:!1}),(0,s.jsx)(j.W,{type:"number",unit:"M"}),(0,s.jsx)(g.h,{type:"category",dataKey:"name",width:170,tick:{fontSize:11,fill:"#4B5563"}}),(0,s.jsx)(p.m,{formatter:e=>"".concat("number"==typeof e?e.toFixed(1):e,"M QAR")}),(0,s.jsx)(u.y,{dataKey:"value",fill:"#0d9488",children:e.map((e,t)=>(0,s.jsx)(f.f,{fill:P[e.Status]},"cell-".concat(t)))})]})})})})})]}),(0,s.jsxs)(n,{className:"bg-white shadow-lg flex-1",children:[(0,s.jsx)(c,{children:(0,s.jsx)(d,{className:"text-xl font-light",children:"Project Value vs Resources"})}),(0,s.jsx)(x,{children:(0,s.jsx)(F,{children:(0,s.jsx)("div",{className:"h-[350px]",children:(0,s.jsx)(o.u,{width:"100%",height:"100%",children:(0,s.jsxs)(N.X,{data:V,children:[(0,s.jsx)(h.d,{strokeDasharray:"6 6",stroke:"#e2e8f0"}),(0,s.jsx)(j.W,{dataKey:"Contract Value",tickFormatter:e=>Math.round(e).toString(),label:{value:"Contract Value (M QAR)",position:"bottom",offset:-7,sort:!0}}),(0,s.jsx)(g.h,{dataKey:"manpower",label:{value:"Manpower",angle:-90,position:"insideLeft"}}),(0,s.jsx)(p.m,{}),(0,s.jsx)(y.X,{name:"Projects",data:V,fill:"#0d9488",children:V.map((e,t)=>(0,s.jsx)(f.f,{fill:P[e.status],opacity:.7},"cell-".concat(t)))}),(0,s.jsx)(b.G,{type:"monotone",dataKey:"progress",stroke:"#2dd4bf",fill:"#2dd4bf",fillOpacity:.1})]})})})})})]}),(0,s.jsxs)(n,{className:"bg-white shadow-lg flex-1",children:[(0,s.jsx)(c,{children:(0,s.jsx)(d,{className:"text-xl font-light",children:"Projects Time Allocation"})}),(0,s.jsx)(x,{children:(0,s.jsxs)("div",{className:"flex flex-col h-[350px]",children:[(0,s.jsx)(F,{children:(0,s.jsx)("div",{className:"flex-1 h-full",children:(0,s.jsx)(o.u,{width:"100%",height:280,children:(0,s.jsxs)(v.r,{margin:{top:0,right:0,left:0,bottom:0},children:[(0,s.jsx)(w.F,{data:e.map(e=>({name:e["Project Name"],value:S(e["Time spending"])})),cx:"50%",cy:"50%",outerRadius:80,innerRadius:10,dataKey:"value",nameKey:"name",label:e=>{let{cx:t,cy:a,midAngle:r,innerRadius:l,outerRadius:i,value:n,name:c}=e,d=Math.PI/180,x=i+15,o=t+x*Math.cos(-r*d),m=a+x*Math.sin(-r*d),h=c.split(" "),j=h.slice(0,2).join(" "),g=h.slice(2).join(" ");return(0,s.jsxs)("g",{children:[(0,s.jsx)("text",{x:o,y:m-6,fill:"#4B5563",textAnchor:o>t?"start":"end",fontSize:"9",children:j}),g&&(0,s.jsx)("text",{x:o,y:m+6,fill:"#4B5563",textAnchor:o>t?"start":"end",fontSize:"9",children:"".concat(g," (").concat(n,"%)")}),!g&&(0,s.jsx)("text",{x:o,y:m+6,fill:"#4B5563",textAnchor:o>t?"start":"end",fontSize:"9",children:"(".concat(n,"%)")})]})},labelLine:!0,children:e.map((e,t)=>(0,s.jsx)(f.f,{fill:P[e.Status]},"cell-".concat(t)))}),(0,s.jsx)(p.m,{formatter:e=>"".concat(e,"%")})]})})})}),(0,s.jsx)("div",{className:"flex justify-center gap-4 mt-4",children:Object.entries(P).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a}}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:t})]},t)})})]})})]})]})]}),(0,s.jsx)("div",{className:"time-allocation-section page-break",children:(0,s.jsxs)(n,{className:"bg-white shadow-lg mb-8 page-break",children:[(0,s.jsx)(c,{children:(0,s.jsx)(d,{className:"text-xl font-light",children:"Project Time Allocation & Progress"})}),(0,s.jsx)(x,{children:(0,s.jsx)("div",{className:"space-y-6",children:e.map((e,t)=>{let a=D(e["Time spending"]);return(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsxs)("div",{className:"w-1/4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:e["Project Name"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["SAP ID: ",e["SAP ID"]]}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Total Duration: ",e["Duration (Months)"]," months"]})]}),(0,s.jsxs)("div",{className:"w-3/4",children:[(0,s.jsxs)("div",{className:"relative h-6 bg-gray-100 rounded-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full transition-all duration-500",style:{width:"".concat(100*a,"%"),backgroundColor:P[e.Status]}}),(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full flex items-center",style:{marginLeft:"".concat(Math.min(100*a+1,95),"%")},children:(0,s.jsxs)("span",{className:"text-xs text-gray-700 font-medium whitespace-nowrap",children:[(100*a).toFixed(0),"% allocated time"]})})]}),(0,s.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"text-gray-600 font-medium",children:"Start: "}),(0,s.jsx)("span",{className:"text-gray-500",children:e["Start Date"]})]}),(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"text-gray-600 font-medium",children:"Time Remaining: "}),(0,s.jsxs)("span",{className:"text-gray-500",children:[E(e["End Date"])," months"]})]}),(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"text-gray-600 font-medium",children:"End: "}),(0,s.jsx)("span",{className:"text-gray-500",children:e["End Date"]})]})]})]})]})},t)})})})]})}),(0,s.jsx)("div",{className:"project-details-section page-break",children:(0,s.jsxs)(n,{className:"bg-white shadow-lg page-break",children:[(0,s.jsx)(c,{children:(0,s.jsx)(d,{className:"text-xl font-light",children:"Project Details"})}),(0,s.jsx)(x,{children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Value (QAR)"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Manpower"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criticality"})]})}),(0,s.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[e.map((e,t)=>{let a=k(e["Project Name"]),r=C[a];return(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-6 py-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e["Project Name"]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e["SAP ID"]})]}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"text-sm text-gray-900",children:[(S(e["Contract Value"])/1e6).toFixed(1),"M"]})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"text-sm text-gray-900",children:S(e.manpower)})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("Ongoing"===e.Status?"bg-teal-100 text-teal-800":"Mobilisation"===e.Status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.Status})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(r.bg," ").concat(r.text),children:a})})]},t)}),(0,s.jsxs)("tr",{className:"bg-gray-50 font-medium",children:[(0,s.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:"Total"}),(0,s.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900",children:[(T/1e6).toFixed(1),"M"]}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:A}),(0,s.jsx)("td",{className:"px-6 py-4"}),(0,s.jsx)("td",{className:"px-6 py-4"})]})]})]})})})]})}),(0,s.jsx)("div",{className:"fixed bottom-8 right-8 no-print",children:(0,s.jsxs)("button",{onClick:()=>{window.print()},className:"px-6 py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2 shadow-md",children:[(0,s.jsx)(l.A,{className:"h-5 w-5"}),"Print Dashboard"]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[524,498,441,517,358],()=>t(16793)),_N_E=e.O()}]);