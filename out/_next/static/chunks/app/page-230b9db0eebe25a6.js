(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{83686:()=>{},32383:()=>{},72153:(e,t,s)=>{Promise.resolve().then(s.bind(s,43531))},43531:(e,t,s)=>{"use strict";s.d(t,{default:()=>O});var a=s(95155),r=s(12115),l=s(92510),i=s(7660);let n=r.forwardRef((e,t)=>{let{className:s="",...r}=e;return(0,a.jsx)("div",{ref:t,className:"rounded-lg border bg-card text-card-foreground shadow-sm ".concat(s),...r})});n.displayName="Card";let c=r.forwardRef((e,t)=>{let{className:s="",...r}=e;return(0,a.jsx)("div",{ref:t,className:"flex flex-col space-y-1.5 p-6 ".concat(s),...r})});c.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:s="",...r}=e;return(0,a.jsx)("h3",{ref:t,className:"text-2xl font-semibold leading-none tracking-tight ".concat(s),...r})});d.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:s="",...r}=e;return(0,a.jsx)("p",{ref:t,className:"text-sm text-muted-foreground ".concat(s),...r})}).displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s="",...r}=e;return(0,a.jsx)("div",{ref:t,className:"p-6 pt-0 ".concat(s),...r})});o.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s="",...r}=e;return(0,a.jsx)("div",{ref:t,className:"flex items-center p-6 pt-0 ".concat(s),...r})}).displayName="CardFooter";var x=s(58581),m=s(66833),h=s(75483),g=s(89507),j=s(38872),p=s(56179),u=s(86354),f=s(56695),N=s(15255),y=s(12800),b=s(66963),w=s(27112),v=s(8710),P=s(67732),D=s(90518);let C={Ongoing:"#0d9488",Mobilisation:"#0369a1","Not Started":"#64748b"},M={High:{bg:"bg-red-100",text:"text-red-800"},Medium:{bg:"bg-yellow-100",text:"text-yellow-800"},Normal:{bg:"bg-green-100",text:"text-green-800"}},S={"Commercial Boulevard District Lusail":"High","Korean Medical Center":"Normal","Al Seef Tower":"Medium","Pumping Stations":"High","QNB Tower":"High","QD Tower Lusail Plaza Tower Plot 4":"Normal","Lusail Plaza Tower # 1 (Plot 1)":"High"},k=e=>"string"==typeof e?parseFloat(e.replace(/,/g,""))||0:"number"==typeof e?e:0,E=e=>"string"==typeof e?parseFloat(e.replace("%",""))/100||0:"number"==typeof e?e:0,T=e=>S[e]||"Normal",F=e=>{if(!e)return 0;try{let[t,s,a]=e.split("-"),r=parseInt(t,10),l=2e3+parseInt(a,10),i=new Date(l,{Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[s],r),n=new Date,c=i.getFullYear()-n.getFullYear(),d=i.getMonth()-n.getMonth(),o=i.getDate()-n.getDate();return Math.max(0,Math.ceil(12*c+d+o/30))}catch(e){return console.error("Error calculating time remaining:",e),0}};class V extends r.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Chart Error:",e,t)}render(){return this.state.hasError?(0,a.jsx)("div",{className:"flex items-center justify-center h-96 bg-gray-50 rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-2",children:"Unable to load chart"}),(0,a.jsx)("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"text-sm text-blue-500 hover:text-blue-600",children:"Try again"})]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null}}}let A=e=>{let{children:t}=e,[s,l]=r.useState({width:0,height:0}),i=r.useRef(null);return r.useEffect(()=>{let e=()=>{i.current&&l({width:i.current.offsetWidth,height:i.current.offsetHeight})};e(),window.addEventListener("resize",e);let t=setTimeout(e,100);return()=>{window.removeEventListener("resize",e),clearTimeout(t)}},[]),(0,a.jsx)("div",{ref:i,className:"h-96 w-full",style:{minHeight:"400px"},children:s.width>0&&s.height>0&&(0,a.jsx)(x.u,{width:"100%",height:"100%",debounce:50,children:t})})},O=()=>{let[e,t]=r.useState([]),[s,x]=r.useState(!0);if(r.useEffect(()=>{(async()=>{try{x(!0);let e=await fetch("/One Page Portfolio.xlsx");if(!e.ok)throw Error("Failed to fetch data: ".concat(e.status," ").concat(e.statusText));let s=await e.arrayBuffer(),a=i.LF(new Uint8Array(s),{type:"array",cellDates:!1,cellNF:!0,cellText:!1,cellStyles:!0}),r=a.Sheets[a.SheetNames[0]],l=i.Wp.sheet_to_json(r,{raw:!1,dateNF:"dd/mm/yyyy"}).filter(e=>e["Project Name"]&&"Total"!==e["Project Name"]&&e.Status in C);t(l)}catch(e){console.error("Error loading data:",e)}finally{x(!1)}})()},[]),s)return(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsx)("div",{className:"text-lg text-gray-600",children:"Loading portfolio data..."})});let S=e.reduce((e,t)=>e+k(t["Contract Value"]),0),O=e.reduce((e,t)=>e+k(t.manpower),0),R=e.map(t=>({name:t["Project Name"],"Contract Value":k(t["Contract Value"])/S*100,Duration:k(t["Duration (Months)"])/e.reduce((e,t)=>Math.max(e,k(t["Duration (Months)"])),0)*100,Manpower:k(t.manpower)/O*100,Progress:100*E(t["Time spending"])})),L=e.map(e=>({name:e["Project Name"],"Contract Value":k(e["Contract Value"])/1e6,manpower:k(e.manpower),"Duration (Months)":k(e["Duration (Months)"]),status:e.Status,progress:100*E(e["Time spending"])}));return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-gray-50 print:bg-white",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-8 print:p-4",children:[(0,a.jsx)("div",{className:"mb-8 bg-white rounded-xl shadow-lg p-8 border border-teal-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-light text-gray-800 mb-2",children:"Portfolio Overview"}),(0,a.jsx)("p",{className:"text-gray-500 text-xl",children:"Yahya Chaker"}),(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"FM Projects Director"})]}),(0,a.jsxs)("div",{className:"flex gap-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-4xl font-light text-teal-600",children:e.length}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Projects"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-4xl font-light text-teal-600",children:[(S/1e6).toFixed(1),"M"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"QAR Value"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-4xl font-light text-teal-600",children:O}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Personnel"})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)(n,{className:"bg-white shadow-lg",children:[(0,a.jsx)(c,{children:(0,a.jsx)(d,{className:"text-xl font-light text-center",children:"Project Performance Matrix"})}),(0,a.jsx)(o,{className:"flex flex-col items-center justify-center",children:(0,a.jsx)(V,{children:(0,a.jsx)(A,{children:(0,a.jsxs)(m.V,{data:R,children:[(0,a.jsx)(h.z,{stroke:"#e2e8f0"}),(0,a.jsx)(g.r,{dataKey:"name",tick:{fill:"#64748b",fontSize:12}}),(0,a.jsx)(j.E,{angle:30,domain:[0,100]}),(0,a.jsx)(p.V,{name:"Project Metrics",dataKey:"Contract Value",stroke:"#0d9488",fill:"#0d9488",fillOpacity:.3}),(0,a.jsx)(p.V,{name:"Duration",dataKey:"Duration",stroke:"#0369a1",fill:"#0369a1",fillOpacity:.3}),(0,a.jsx)(p.V,{name:"Progress",dataKey:"Progress",stroke:"#2dd4bf",fill:"#2dd4bf",fillOpacity:.3}),(0,a.jsx)(u.s,{align:"center",verticalAlign:"bottom",layout:"horizontal"})]})})})})]}),(0,a.jsxs)(n,{className:"bg-white shadow-lg",children:[(0,a.jsx)(c,{children:(0,a.jsx)(d,{className:"text-xl font-light text-center",children:"Project Value vs Resources"})}),(0,a.jsx)(o,{className:"flex flex-col items-center justify-center",children:(0,a.jsx)(V,{children:(0,a.jsx)(A,{children:(0,a.jsxs)(f.X,{data:L,margin:{top:20,right:30,left:20,bottom:40},children:[(0,a.jsx)(N.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,a.jsx)(y.W,{dataKey:"Contract Value",label:{value:"Contract Value (M QAR)",position:"bottom",offset:0}}),(0,a.jsx)(b.h,{dataKey:"manpower",label:{value:"Manpower",angle:-90,position:"insideLeft",offset:-10}}),(0,a.jsx)(w.m,{}),(0,a.jsx)(u.s,{align:"center",verticalAlign:"bottom",layout:"horizontal",content:e=>{let{payload:t}=e;return(0,a.jsxs)("div",{className:"flex justify-center gap-6 p-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-teal-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Ongoing"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Mobilisation"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-500"}),(0,a.jsx)("span",{className:"text-sm",children:"Not Started"})]})]})}}),(0,a.jsx)(v.X,{name:"Projects",data:L,fill:"#0d9488",children:L.map((e,t)=>(0,a.jsx)(P.f,{fill:C[e.status],opacity:.7},"cell-".concat(t)))}),(0,a.jsx)(D.G,{name:"Progress",type:"monotone",dataKey:"progress",stroke:"#2dd4bf",fill:"#2dd4bf",fillOpacity:.1})]})})})})]})]}),(0,a.jsxs)(n,{className:"bg-white shadow-lg mb-8 time-allocation-section",children:[(0,a.jsx)(c,{children:(0,a.jsx)(d,{className:"text-xl font-light",children:"Project Time Allocation & Progress"})}),(0,a.jsx)(o,{children:(0,a.jsx)("div",{className:"space-y-6",children:e.map((e,t)=>{let s=E(e["Time spending"]);return(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsxs)("div",{className:"w-1/4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:e["Project Name"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["SAP ID: ",e["SAP ID"]]}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Total Duration: ",e["Duration (Months)"]," months"]})]}),(0,a.jsxs)("div",{className:"w-3/4",children:[(0,a.jsxs)("div",{className:"relative h-6 bg-gray-100 rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 h-full transition-all duration-500",style:{width:"".concat(100*s,"%"),backgroundColor:C[e.Status]}}),(0,a.jsx)("div",{className:"absolute top-0 left-0 h-full flex items-center",style:{marginLeft:"".concat(Math.min(100*s+1,95),"%")},children:(0,a.jsxs)("span",{className:"text-xs text-gray-700 font-medium whitespace-nowrap",children:[(100*s).toFixed(0),"% allocated time"]})})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"text-gray-600 font-medium",children:"Start: "}),(0,a.jsx)("span",{className:"text-gray-500",children:e["Start Date"]})]}),(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"text-gray-600 font-medium",children:"Time Remaining: "}),(0,a.jsxs)("span",{className:"text-gray-500",children:[F(e["End Date"])," months"]})]}),(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"text-gray-600 font-medium",children:"End: "}),(0,a.jsx)("span",{className:"text-gray-500",children:e["End Date"]})]})]})]})]})},t)})})})]}),(0,a.jsxs)(n,{className:"bg-white shadow-lg project-details-section",children:[(0,a.jsx)(c,{children:(0,a.jsx)(d,{className:"text-xl font-light",children:"Project Details"})}),(0,a.jsx)(o,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Value (QAR)"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Manpower"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criticality"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[e.map((e,t)=>{let s=T(e["Project Name"]),r=M[s];return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"px-6 py-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e["Project Name"]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e["SAP ID"]})]}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:[(k(e["Contract Value"])/1e6).toFixed(1),"M"]})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:k(e.manpower)})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("Ongoing"===e.Status?"bg-teal-100 text-teal-800":"Mobilisation"===e.Status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.Status})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(r.bg," ").concat(r.text),children:s})})]},t)}),(0,a.jsxs)("tr",{className:"bg-gray-50 font-medium",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:"Total"}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900",children:[(S/1e6).toFixed(1),"M"]}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:O}),(0,a.jsx)("td",{className:"px-6 py-4"}),(0,a.jsx)("td",{className:"px-6 py-4"})]})]})]})})})]}),(0,a.jsx)("div",{className:"fixed bottom-8 right-8 no-print",children:(0,a.jsxs)("button",{onClick:()=>{window.print()},className:"px-6 py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2 shadow-md",children:[(0,a.jsx)(l.A,{className:"h-5 w-5"}),"Print Dashboard"]})})]})}),(0,a.jsx)(()=>{let e=new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"});return(0,a.jsx)("div",{className:"hidden print:block print-footer",style:{position:"fixed",bottom:0,left:0,right:0,width:"100%",backgroundColor:"white",borderTop:"1px solid #e5e7eb",zIndex:9999},children:(0,a.jsxs)("div",{className:"flex justify-between items-center text-gray-600 px-8 py-4 w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"font-medium",children:"Portfolio Dashboard"}),(0,a.jsx)("span",{className:"text-gray-400",children:"|"}),(0,a.jsx)("span",{children:"Yahya Chaker - FM Projects Director"})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{children:e})})]})})},{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[524,456,441,517,358],()=>t(72153)),_N_E=e.O()}]);